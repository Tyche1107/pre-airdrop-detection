<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pre-Airdrop Sybil Detection</title>
<style>
  :root{--bg:#0f1117;--bg2:#1a202c;--bg3:#2d3748;--border:#2d3748;--border2:#4a5568;--text:#e2e8f0;--text2:#cbd5e0;--text3:#94a3b8;--text4:#718096;--purple:#a78bfa;--green:#68d391;--red:#fc8181;--yellow:#f6e05e;}
  [data-theme="light"]{--bg:#f7fafc;--bg2:#edf2f7;--bg3:#e2e8f0;--border:#e2e8f0;--border2:#cbd5e0;--text:#1a202c;--text2:#2d3748;--text3:#4a5568;--text4:#718096;--purple:#6b46c1;--green:#276749;--red:#c53030;--yellow:#b7791f;}
  *{box-sizing:border-box;}
  body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:var(--text);padding:20px 28px;line-height:1.6;margin:0;}
  h1{font-size:18px;color:var(--purple);margin-bottom:12px;border-bottom:1px solid var(--border);padding-bottom:8px;}
  .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:14px;}
  .controls input{background:var(--bg2);border:1px solid var(--border2);color:var(--text);padding:5px 12px;border-radius:5px;font-size:13px;width:200px;outline:none;}
  .controls input:focus{border-color:var(--purple);}
  .btn{background:var(--bg2);border:1px solid var(--border2);color:var(--text3);padding:5px 12px;border-radius:5px;cursor:pointer;font-size:12px;}
  .btn:hover{background:var(--bg3);}
  details{margin:3px 0;border-left:2px solid var(--border2);padding-left:12px;}
  details[open]>summary{color:var(--purple);}
  summary{cursor:pointer;padding:5px 6px;border-radius:5px;font-weight:600;color:var(--text2);list-style:none;display:flex;align-items:center;gap:7px;font-size:13px;user-select:none;}
  summary::-webkit-details-marker{display:none;}
  summary:hover{background:var(--bg2);}
  summary::before{content:'';width:7px;height:7px;border:1.5px solid var(--text4);border-radius:1px;flex-shrink:0;transform:rotate(45deg);transition:transform .15s;}
  details[open]>summary::before{transform:rotate(135deg);border-color:var(--purple);}
  .body{padding:4px 4px 8px 20px;font-size:12.5px;color:var(--text3);}
  .tag{font-size:11px;background:var(--bg3);color:var(--text4);border-radius:3px;padding:1px 6px;font-weight:normal;margin-left:4px;}
  .tag.done{background:#1a3a1a;color:var(--green);}
  .tag.data{background:#1a2a3a;color:#63b3ed;}
  .tag.pending{background:#3a2a00;color:var(--yellow);}
  .tag.model{background:#1f2937;color:#a5f3fc;border:1px solid #164e63;}
  table{border-collapse:collapse;margin:6px 0;font-size:12px;width:100%;max-width:680px;}
  th{color:var(--purple);text-align:left;padding:3px 12px 3px 0;border-bottom:1px solid var(--border);font-size:11px;font-weight:600;}
  td{padding:3px 12px 3px 0;color:var(--text2);border-bottom:1px solid var(--border);}
  td.hi{color:var(--green);font-weight:600;}td.lo{color:var(--red);}td.mid{color:var(--yellow);}
  .find{background:var(--bg2);border-left:3px solid var(--green);padding:5px 12px;border-radius:0 5px 5px 0;margin:6px 0;font-size:12px;color:var(--text);}
  .note{background:var(--bg2);border-left:3px solid #4a90d9;padding:5px 12px;border-radius:0 5px 5px 0;margin:6px 0;font-size:12px;color:var(--text3);}
  .warn{background:var(--bg2);border-left:3px solid var(--red);padding:5px 12px;border-radius:0 5px 5px 0;margin:6px 0;font-size:12px;color:var(--text);}
  img.plot{width:100%;max-width:760px;border-radius:6px;margin:8px 0 3px;border:1px solid var(--border);cursor:zoom-in;display:block;}
  .sec{font-size:12px;font-weight:700;color:var(--purple);margin:20px 0 6px;padding:6px 12px;background:var(--bg2);border-radius:5px;border-left:3px solid var(--purple);}
  .lightbox{display:none;position:fixed;inset:0;background:rgba(0,0,0,.88);z-index:1000;align-items:center;justify-content:center;cursor:zoom-out;}
  .lightbox.open{display:flex;}
  .lightbox img{max-width:92vw;max-height:92vh;border-radius:8px;}
</style>
</head>
<body>

<h1>Pre-Airdrop Sybil Detection — Experiment Map</h1>
<div class="controls">
  <input type="text" placeholder="搜索实验..." oninput="doSearch(this.value)">
  <button class="btn" onclick="setAll(true)">全部展开</button>
  <button class="btn" onclick="setAll(false)">全部折叠</button>
  <button class="btn" onclick="toggleTheme()">亮 / 暗</button>
</div>

<!-- ===== 数据集 ===== -->
<div class="sec">核心结论</div>
<div class="body" style="padding:10px 16px 14px;background:var(--bg2);border-radius:8px;margin-bottom:10px;border-left:3px solid var(--purple)">
  <ol style="margin:0;padding-left:1.4em;line-height:2;font-size:13px;color:var(--text2)">
    <li><strong>事前检测可行。</strong> 纯行为特征 T-30 AUC <strong>0.793</strong>，差 ARTEMIS 事后 GNN（0.803）仅 <strong>0.010</strong>。</li>
    <li><strong>信号跨时间稳定。</strong> T-0 到 T-90 AUC 仅降 0.009（Blur）/ 0.0006（LZ）。猎人从开始刷积分就留下可识别指纹。</li>
    <li><strong>跨协议泛化成立。</strong> LZ T-30 AUC <strong>0.946</strong>，超过 ARTEMIS 基线。Zero-shot 0.434，1% 微调 → 0.982。</li>
    <li><strong>女巫行为极度分化。</strong> K=2 聚类：散户猎人 8,884 个 vs 超级 bot 6 个（avg 9,099 笔）。四类 flag（BW/ML/FD/HF）几乎不重叠，留一检测 AUC 0.09-0.39。</li>
    <li><strong>GNN 依赖空投时序，LightGBM 不依赖。</strong> 事前 ArtemisNet 从 0.976 跌至 0.586；行为特征模型不受时序影响。</li>
    <li><strong>开放世界两阶段可行。</strong> IF 恢复未见类型 AUC 0.740（纯监督 0.133），Oracle 上界 0.975。</li>
  </ol>
</div>

<div class="sec">数据来源 &amp; 模型</div>
<div class="body" style="padding:10px 16px 14px;background:var(--bg2);border-radius:8px;margin-bottom:10px;">
  <table>
    <tr><th>数据集</th><th>规模</th><th>标签来源</th><th>用途</th></tr>
    <tr><td>Blur NFT Season 2</td><td>53,482 空投用户 / 9,817 sybil / 43,665 normal</td><td>behavior_flags（bw/ml/fd/hf）</td><td>主实验 Q1-Q5</td></tr>
    <tr><td>LayerZero ETH</td><td>29,870 地址</td><td>官方 Proof-of-Sybil 名单</td><td>第二验证 Exp 28, 24</td></tr>
    <tr><td>Hop Protocol</td><td>~4K 地址</td><td>官方 sybil 名单</td><td>跨协议 LOPO Exp 17, 16</td></tr>
    <tr><td>Gitcoin</td><td>39,962 地址</td><td>SADScore</td><td>跨协议 LOPO Exp 17, 18</td></tr>
    <tr><td>ARTEMIS GNN</td><td>Blur-main/*.pt</td><td>同 Blur（post-hoc）</td><td>对比基线 Exp 09, 15</td></tr>
  </table>
  <table style="margin-top:10px;">
    <tr><th>模型</th><th>参数</th><th>实验</th></tr>
    <tr><td>LightGBM</td><td>5-fold CV, n_estimators=500, early_stop=50</td><td>Exp 03-08, 10-14, 17-19, 21-23, 25-28</td></tr>
    <tr><td>GraphSAGE (ArtemisNet)</td><td>2层, hidden=128, 预训练权重</td><td>Exp 09, 15</td></tr>
    <tr><td>K-Means</td><td>K=2 (Silhouette 0.962), StandardScaler</td><td>Exp 11, 20</td></tr>
    <tr><td>Isolation Forest</td><td>contamination=0.18, n_estimators=200</td><td>Exp 25</td></tr>
    <tr><td>Isotonic Regression</td><td>CalibratedClassifierCV</td><td>Exp 22</td></tr>
    <tr><td>Random Forest / LR</td><td>RF n=300 / LR C=1.0</td><td>Exp 27（基线对比）</td></tr>
  </table>
</div>

<div class="sec">数据集</div>

<details>
<summary>Blur NFT Season 2 <span class="tag data">主数据集</span><span class="tag data">53K airdrop users</span></summary>
<div class="body">
  <table>
    <tr><th>文件</th><th>用途</th><th>规模</th></tr>
    <tr><td>TXS2_1662_1861.csv</td><td>特征提取来源（全体 Blur 用户交易）</td><td>3.2M 行，251K 地址</td></tr>
    <tr><td>addresses_all_with_loaylty_blend_blur_label319.csv</td><td>Blend / LP / unique_interactions 扩展特征</td><td>251,755 地址</td></tr>
    <tr><td>airdrop_targets_behavior_flags.csv</td><td>Ground truth：4 类行为 flag</td><td>53,482 地址</td></tr>
  </table>
  <div class="note">
    bw_flag: 批量提取（non-CEX funder >= 5 targets） / ml_flag: NFT 循环洗钱（cycle >= 5） / fd_flag: 快速转移 / hf_flag: 高频交易<br>
    Sybil (任一 flag=1): 9,817 | Normal (全0): 43,665 | 训练集限定为 53K 空投用户，不含其余 TXS2 用户
  </div>
</div>
</details>

<details>
<summary>LayerZero <span class="tag data">第二数据集</span><span class="tag data">29,870 地址 ETH-only</span></summary>
<div class="body">
  <table>
    <tr><th>文件</th><th>用途</th></tr>
    <tr><td>layerzero/lz_temporal_features.csv</td><td>T-30/60/90 时序特征（Alchemy API，ETH mainnet）</td></tr>
    <tr><td>LayerZero Proof-of-Sybil</td><td>官方 sybil 地址名单（ground truth）</td></tr>
  </table>
  <div class="note">ARB + POLY 网络未启用，当前特征仅 ETH 侧。</div>
</div>
</details>

<details>
<summary>Hop + Gitcoin <span class="tag data">跨协议对比</span></summary>
<div class="body">
  <table>
    <tr><th>协议</th><th>特征文件</th><th>标签</th></tr>
    <tr><td>Hop</td><td>hop/metadata.csv, timestamps.csv</td><td>hop/sybil_addresses.csv（官方）</td></tr>
    <tr><td>Gitcoin</td><td>gitcoin/onchain_features.csv, erc20_features.csv</td><td>SADScore（39,962 地址）</td></tr>
  </table>
</div>
</details>

<details>
<summary>ARTEMIS GNN 数据 <span class="tag data">对比基线</span></summary>
<div class="body">
</div>
</details>

<!-- ===== Q1 ===== -->
<div class="sec">Q1: 能不能提前检测？</div>

<details open>
<summary>[03] 时间消融 T-0 到T-90 <span class="tag done">Done</span> <span class="tag">T-30 AUC 0.793</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>窗口</th><th>活跃人数</th><th>女巫率</th><th>AUC</th><th>F1</th></tr>
    <tr><td>T-0</td><td>50,564</td><td>18.0%</td><td class="hi">0.798</td><td>0.539</td></tr>
    <tr><td>T-7</td><td>50,461</td><td>18.0%</td><td class="hi">0.796</td><td>0.533</td></tr>
    <tr><td>T-14</td><td>50,239</td><td>17.9%</td><td class="hi">0.796</td><td>0.532</td></tr>
    <tr><td>T-30</td><td>49,646</td><td>17.9%</td><td class="hi">0.793</td><td>0.529</td></tr>
    <tr><td>T-60</td><td>48,801</td><td>17.7%</td><td class="hi">0.791</td><td>0.521</td></tr>
    <tr><td>T-90</td><td>47,706</td><td>17.4%</td><td class="hi">0.789</td><td>0.520</td></tr>
  </table>
  <div class="find">T-0 到 T-90 AUC 仅降 0.009。事前行为信号稳定，猎人从开始刷积分就留下可识别的指纹。</div>
  <div class="note">ARTEMIS 事后 GNN AUC 0.803；本文用纯事前行为特征达到 0.793，差距 0.010。</div>
  <img class="plot" src="data/temporal_ablation_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[12] 扩展消融 T-120 到 T-180 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>窗口</th><th>AUC</th></tr>
    <tr><td>T-120</td><td class="hi">0.786</td></tr>
    <tr><td>T-150</td><td class="hi">0.784</td></tr>
    <tr><td>T-180</td><td class="hi">0.780</td></tr>
  </table>
  <div class="find">6 个月前仍有效，猎人在激励期开始时就已经在操作。</div>
  <img class="plot" src="data/temporal_ablation_extended_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[05] Precision-Recall 分析 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <img class="plot" src="data/pr_and_comparison_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[09][15] GNN 事后 vs 事前对比 <span class="tag done">Done</span> <span class="tag model">GraphSAGE / GNN</span></summary>
<div class="body">
  <table>
    <tr><th>模型</th><th>数据时机</th><th>AUC</th></tr>
    <tr><td>ArtemisNet GNN（复现）</td><td>事后</td><td class="hi">0.976</td></tr>
    <tr><td>ArtemisNet GNN（T-30 事前）</td><td>事前</td><td class="lo">0.586</td></tr>
    <tr><td>LightGBM（本文，T-30）</td><td>事前</td><td class="hi">0.793</td></tr>
  </table>
  <div class="warn">GNN 依赖空投后产生的 transfer edge；事前图残缺，性能降至 0.586。LightGBM 用行为特征绕过此限制。</div>
</div>
</details>

<!-- ===== Q2 ===== -->
<div class="sec">Q2: 哪些特征有效？</div>

<details>
<summary>[04] 特征重要性（跨时间窗）<span class="tag done">Done</span> <span class="tag model">LightGBM + SHAP</span></summary>
<div class="body">
  <table>
    <tr><th>特征</th><th>T-0</th><th>T-30</th><th>T-90</th></tr>
    <tr><td>buy_collections（NFT多样性）</td><td class="hi">48%</td><td>44%</td><td>38%</td></tr>
    <tr><td>unique_interactions</td><td>7%</td><td>14%</td><td class="hi">22%</td></tr>
    <tr><td>buy_value</td><td>12%</td><td>12%</td><td>12%</td></tr>
  </table>
  <div class="find">NFT 集合多样性稳定第一。越早期 unique_interactions 权重越高，模型更依赖合约交互广度而非交易量。</div>
  <img class="plot" src="data/feature_stability_plot.png" onclick="openLightbox(this)">
</div>
</details>





<details>
<summary>[06] 特征组消融 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>特征组</th><th>AUC（仅此组）</th></tr>
    <tr><td>ALL（全部特征）</td><td class="hi">0.7904</td></tr>
    <tr><td>Behavioral（行为模式）</td><td class="hi">0.7304</td></tr>
    <tr><td>Activity（交易频率）</td><td>0.6741</td></tr>
    <tr><td>Volume（金额）</td><td>0.6578</td></tr>
    <tr><td>Diversity（NFT多样性）</td><td>0.5931</td></tr>
    <tr><td>DeFi（Blend操作）</td><td class="lo">0.5256</td></tr>
  </table>
  <img class="plot" src="data/ablation_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[07] 图特征增强 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>特征集</th><th>AUC</th></tr>
    <tr><td>行为特征</td><td class="hi">0.904</td></tr>
    <tr><td>图特征（funder graph）</td><td>0.873</td></tr>
    <tr><td>行为 + 图</td><td class="hi">0.905</td></tr>
  </table>
  <img class="plot" src="data/graph_augmentation_plot.png" onclick="openLightbox(this)">
</div>
</details>

<!-- ===== Q3 ===== -->
<div class="sec">Q3: 多鲁棒？</div>

<details>
<summary>[08] 泛化实验 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>实验</th><th>AUC</th></tr>
    <tr><td>标准 5-fold T-30</td><td class="hi">0.7916</td></tr>
    <tr><td>时间泛化（T-90 训练 → T-30 测试）</td><td class="hi">0.7979</td></tr>
    <tr><td>种群泛化（50% 未见 sybil 类型）</td><td class="lo">0.4291</td></tr>
  </table>
  <img class="plot" src="data/generalization_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[26] 标签噪声鲁棒性 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>噪声比例</th><th>AUC</th><th>vs 基线</th></tr>
    <tr><td>0%</td><td class="hi">0.797</td><td>基线</td></tr>
    <tr><td>10%</td><td>0.781</td><td>-0.016</td></tr>
    <tr><td>20%</td><td>0.765</td><td>-0.032</td></tr>
  </table>
  <img class="plot" src="data/label_noise_robustness.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[13][23] 对抗鲁棒性 + 逃避成本 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>Diversity 降低</th><th>AUC</th><th>积分保留</th></tr>
    <tr><td>0%（基线）</td><td class="hi">0.794</td><td>100%</td></tr>
    <tr><td>50%</td><td>0.792</td><td>71%</td></tr>
    <tr><td>90%</td><td>0.788</td><td>33%</td></tr>
  </table>
  <div class="find">逃避检测的代价（积分损失）远超被检测的风险，在经济上不合算。</div>
  <img class="plot" src="data/adversarial_cost_tradeoff.png" onclick="openLightbox(this)">
</div>
</details>

<!-- ===== Q4 ===== -->
<div class="sec">Q4: 能跨协议吗？</div>

<details open>
<summary>[28] LayerZero 时间消融 <span class="tag done">Done</span> <span class="tag">T-30 AUC 0.946</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>窗口</th><th>活跃地址</th><th>AUC</th></tr>
    <tr><td>T-30</td><td>17,072</td><td class="hi">0.9462</td></tr>
    <tr><td>T-60</td><td>16,781</td><td class="hi">0.9468</td></tr>
    <tr><td>T-90</td><td>15,616</td><td class="hi">0.9462</td></tr>
  </table>
  <div class="find">T-30 到 T-90 range = 0.0006，信号极稳定。桥协议行为模式与 NFT 市场不同但同样可检测。</div>
  <div class="note">ARB + POLY 启用后重跑预计提升。</div>
</div>
</details>

<details>
<summary>[24] LayerZero LOPO <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>训练</th><th>测试</th><th>AUC</th></tr>
    <tr><td>Blur + Hop</td><td>LZ（桥→桥）</td><td class="mid">0.567</td></tr>
    <tr><td>Blur + LZ</td><td>Hop（NFT→桥）</td><td class="lo">0.434</td></tr>
    <tr><td>—</td><td>LZ 域内</td><td class="hi">0.892</td></tr>
  </table>
  <div class="find">同类协议（桥→桥）迁移 0.567，好于跨类（NFT→桥）0.434。协议类型影响迁移效果。</div>
  <img class="plot" src="data/layerzero_lopo.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[17] 公共特征 LOPO（Blur / Gitcoin / Hop）<span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <div class="note">公共特征: tx_count / total_volume / unique_contracts / wallet_age_days / active_span_days</div>
  <table>
    <tr><th>测试</th><th>专属特征 AUC</th><th>公共特征 AUC</th></tr>
    <tr><td>Blur</td><td class="lo">0.220</td><td class="hi">0.624</td></tr>
    <tr><td>Hop</td><td class="lo">0.376</td><td class="hi">0.780</td></tr>
    <tr><td>Gitcoin</td><td class="lo">0.466</td><td class="mid">0.468</td></tr>
  </table>
  <div class="find">特征对齐后 Blur-Hop 零样本 0.38 → 0.78。Gitcoin 持平，说明捐赠行为本质不同。</div>
</div>
</details>



<details>
<summary>[14][16b] Blur → Hop 迁移 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <div class="note">训练: Blur TXS2（53K，behavior_flags）→ 测试: Hop sybil_addresses.csv</div>
  <table>
    <tr><th>训练数据</th><th>AUC</th></tr>
    <tr><td>Blur only（零样本）</td><td class="lo">0.500</td></tr>
    <tr><td>Blur + 1% Hop 标注</td><td class="hi">0.982</td></tr>
    <tr><td>Blur + 20% Hop 标注</td><td class="hi">0.981</td></tr>
  </table>
  <div class="warn">零样本失败：NFT 专属特征在 Hop 上不存在。1% Hop 标注后直接跳到 0.982。</div>
</div>
</details>

<details>
<summary>[18] Gitcoin 域内分析 <span class="tag done">Done</span> <span class="tag model">LightGBM + SHAP</span></summary>
<div class="body">
  <div class="warn">域内 AUC 0.599。SADScore 标注的是链上整体异常地址，捐赠特征 SHAP 权重近 0，唯一信号是基础链上指标。</div>
  <img class="plot" src="data/gitcoin_shap.png" onclick="openLightbox(this)">
</div>
</details>

<!-- ===== Supporting ===== -->
<div class="sec">Supporting: 规则基线 / 女巫分析 / 校准</div>

<details>
<summary>[27] 规则基线 vs ML <span class="tag done">Done</span> <span class="tag model">LightGBM / RF / LR</span></summary>
<div class="body">
  <table>
    <tr><th>方法</th><th>AUC</th></tr>
    <tr><td>LightGBM</td><td class="hi">0.792</td></tr>
    <tr><td>Random Forest</td><td class="hi">0.791</td></tr>
    <tr><td>Logistic Regression</td><td class="mid">0.676</td></tr>
    <tr><td>规则：高买入量</td><td class="lo">0.526</td></tr>
    <tr><td>规则：钱包年龄 &lt;30d</td><td class="lo">0.507</td></tr>
  </table>
  <img class="plot" src="data/rule_baselines.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[11] 女巫策略聚类 <span class="tag done">Done</span> <span class="tag model">K-Means K=2</span></summary>
<div class="body">
  <div class="note">数据: TXS2 → <strong>仅 8,890 女巫地址</strong>（is_sybil=1）| 模型: K-means，K=2（Silhouette 0.962 最优）</div>
  <table>
    <tr><th>类型</th><th>数量</th><th>avg buy_count</th><th>Blend 操作</th></tr>
    <tr><td>散户猎人（Cluster 0）</td><td class="hi">8,884</td><td>11</td><td>无</td></tr>
    <tr><td>超级机器人（Cluster 1）</td><td>6</td><td class="hi">9,099</td><td class="hi">有（avg 4,248）</td></tr>
  </table>
  <img class="plot" src="data/sybil_clustering_plot.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[20] 聚类 K 值选择 <span class="tag done">Done</span> <span class="tag model">K-Means</span></summary>
<div class="body">
  <img class="plot" src="data/clustering_k_selection.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[21] 按 Flag 类型留一泛化 <span class="tag done">Done</span> <span class="tag model">LightGBM</span></summary>
<div class="body">
  <table>
    <tr><th>留出类型</th><th>n_sybil</th><th>AUC</th></tr>
    <tr><td>BW（批量提取）</td><td>2,225</td><td class="lo">0.126</td></tr>
    <tr><td>FD（快速转移）</td><td>2,519</td><td class="lo">0.159</td></tr>
    <tr><td>ML（NFT循环）</td><td>343</td><td class="lo">0.093</td></tr>
    <tr><td>HF（高频交易）</td><td>490</td><td class="mid">0.388</td></tr>
  </table>
  <div class="find">各 flag 类型间行为差异大，留出任何一类后模型几乎无法检测该类型。需 multi-flag 联合训练。</div>
  <img class="plot" src="data/flag_type_generalization.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[25] 开放世界检测（BW 未见类型）<span class="tag done">Done</span> <span class="tag model">LightGBM + IF</span></summary>
<div class="body">
  <table>
    <tr><th>方法</th><th>AUC（仅 BW 测试）</th></tr>
    <tr><td>LightGBM（无 BW 训练）</td><td class="lo">0.133</td></tr>
    <tr><td>Isolation Forest</td><td class="hi">0.740</td></tr>
    <tr><td>两阶段（LGB + IF）</td><td class="hi">0.740</td></tr>
    <tr><td>Oracle（含 BW 训练）</td><td class="hi">0.975</td></tr>
  </table>
  <img class="plot" src="data/openworld_detection.png" onclick="openLightbox(this)">
</div>
</details>

<details>
<summary>[22] 概率校准 <span class="tag done">Done</span> <span class="tag model">LightGBM + Isotonic</span></summary>
<div class="body">
  <table>
    <tr><th>模型</th><th>AUC</th><th>Brier Score</th></tr>
    <tr><td>原始</td><td>0.788</td><td class="lo">0.156</td></tr>
    <tr><td>Isotonic 校准</td><td class="hi">0.791</td><td class="hi">0.112</td></tr>
  </table>
  <img class="plot" src="data/calibration_curve.png" onclick="openLightbox(this)">
</div>
</details>

<!-- ═══════════════════════════════════════════════════════════════ -->
<!-- AI Workflow Mindmap -->
<!-- ═══════════════════════════════════════════════════════════════ -->

<div class="sec">AI-Powered Research Workflow</div>

<details>
<summary>Architecture Overview <span class="tag">workflow</span></summary>
<div class="body">
<div class="find">Human (Adeline) → AI Agent (小昭/OpenClaw) → Sub-agents (parallel) → Tools (DB/Git/API)</div>
<table>
<tr><th>Layer</th><th>Role</th><th>Tool</th></tr>
<tr><td>Human</td><td>Direction, experiment design, result interpretation</td><td>Telegram / Claude Code</td></tr>
<tr><td>Main Agent</td><td>Task decomposition, coordination, verification</td><td>Claude Opus 4.6 via OpenClaw</td></tr>
<tr><td>Sub-agents</td><td>Parallel execution of experiments</td><td>Claude Sonnet 4.6 (2-3 concurrent)</td></tr>
<tr><td>Tools</td><td>Data storage, code, API calls</td><td>PostgreSQL / Python / Git / Alchemy</td></tr>
</table>
</div>
</details>

<details>
<summary>AI Tool Stack <span class="tag data">tools</span></summary>
<div class="body">

<details>
<summary>Models & Platforms</summary>
<div class="body">
<table>
<tr><th>Tool</th><th>Purpose</th><th>Cost</th></tr>
<tr><td>Claude Code (Max Plan × 2)</td><td>Code generation, debugging, experiment scripts</td><td>$200/mo × 2</td></tr>
<tr><td>Claude Opus 4.6</td><td>Main agent — complex reasoning, task decomposition</td><td>Included</td></tr>
<tr><td>Claude Sonnet 4.6</td><td>Sub-agents — parallel experiment execution</td><td>Included</td></tr>
<tr><td>OpenClaw</td><td>Agent runtime (session/sub-agent/cron management)</td><td>Open source</td></tr>
</table>
</div>
</details>

<details>
<summary>MCP (Model Context Protocol) Integrations</summary>
<div class="body">
<table>
<tr><th>MCP Server</th><th>Function</th></tr>
<tr><td>Supabase</td><td>Direct DB queries/writes without CLI</td></tr>
<tr><td>GitHub</td><td>Create issues, commit, push, PRs</td></tr>
<tr><td>Playwright</td><td>Browser automation for data scraping</td></tr>
<tr><td>Context7</td><td>Up-to-date documentation lookup</td></tr>
</table>
<div class="note">MCP allows AI to directly operate tools (read/write DB, commit code) instead of describing what to do.</div>
</div>
</details>

<details>
<summary>Claude Code Skills (installed)</summary>
<div class="body">
<table>
<tr><th>Skill</th><th>Use</th></tr>
<tr><td>postgres-patterns</td><td>Query optimization, indexing, Supabase patterns</td></tr>
<tr><td>python-patterns</td><td>Python data processing best practices</td></tr>
<tr><td>python-testing</td><td>Automated testing generation</td></tr>
<tr><td>ccxt-python</td><td>Exchange API data fetching</td></tr>
<tr><td>coding-agent</td><td>Delegate tasks to background sub-agents</td></tr>
<tr><td>security-scan</td><td>Security vulnerability detection</td></tr>
</table>
</div>
</details>

<details>
<summary>Claude Code Plugins (42 installed)</summary>
<div class="body">
<table>
<tr><th>Category</th><th>Plugins</th></tr>
<tr><td>Data/DB</td><td>supabase, firebase</td></tr>
<tr><td>Code Quality</td><td>code-review, pr-review-toolkit, security-guidance, code-simplifier</td></tr>
<tr><td>DevOps</td><td>github, gitlab, playwright</td></tr>
<tr><td>Productivity</td><td>slack, linear, asana</td></tr>
<tr><td>Development</td><td>feature-dev, frontend-design, hookify, stripe</td></tr>
<tr><td>AI/Agent</td><td>agent-sdk-dev, skill-creator, plugin-dev</td></tr>
</table>
</div>
</details>

</div>
</details>

<details>
<summary>5-Phase Workflow <span class="tag done">complete</span></summary>
<div class="body">

<details>
<summary>Phase 0: Data Preparation <span class="tag">~3h</span></summary>
<div class="body">
<div class="find">Input: Raw data files on Desktop → Output: PostgreSQL HasciDB with indexed tables</div>
<table>
<tr><th>Step</th><th>What AI Does</th></tr>
<tr><td>1. Explore data</td><td>Read CSV files, understand schema (53,482 users, 4 behavior flags)</td></tr>
<tr><td>2. Design DB</td><td>Create tables: wallets / transactions / transfers / interactions / labels</td></tr>
<tr><td>3. Import</td><td>Bulk import 3.2M transactions + behavior labels</td></tr>
<tr><td>4. Validate</td><td>Verify sybil distribution: 9,817 sybil / 43,665 normal</td></tr>
</table>
<div class="note">Key data: airdrop_targets_behavior_flags.csv (bw/ml/fd/hf flags), TXS2_1662_1861.csv (3.2M NFT txs)</div>
</div>
</details>

<details>
<summary>Phase 1: Feature Engineering <span class="tag">~4h</span></summary>
<div class="body">
<div class="find">20+ behavioral features with temporal cutoff at T-7/14/30/60/90 before airdrop</div>
<table>
<tr><th>Feature Group</th><th>Features</th><th>Top Importance</th></tr>
<tr><td>Trading behavior</td><td>tx_count, buy/sell_count, buy/sell_volume, unique_collections</td><td class="hi">unique_collections: 37-49%</td></tr>
<tr><td>Time patterns</td><td>activity_window_days, avg_tx_interval, max_daily_tx</td><td>activity_window: ~5%</td></tr>
<tr><td>Network</td><td>unique_counterparties, unique_contracts, contract_per_tx</td><td class="hi">unique_interactions: 7-22%</td></tr>
<tr><td>Funding</td><td>recv_sent_ratio, avg_value</td><td>buy_volume: ~12%</td></tr>
</table>
<div class="note">Temporal cutoff: T0 = 2023-11-21 (Blur S2 airdrop). Features computed only from pre-airdrop data.</div>
</div>
</details>

<details>
<summary>Phase 2: LightGBM Training <span class="tag">~2h</span></summary>
<div class="body">
<div class="find">Parallel sub-agents: one per temporal window (T-0 to T-90)</div>
<table>
<tr><th>Window</th><th>AUC (5-fold CV)</th><th>vs ARTEMIS (0.803)</th></tr>
<tr><td>T-0</td><td class="hi">0.798</td><td>-0.005</td></tr>
<tr><td>T-7</td><td class="hi">0.796</td><td>-0.007</td></tr>
<tr><td>T-14</td><td class="hi">0.796</td><td>-0.007</td></tr>
<tr><td>T-30</td><td class="hi">0.793</td><td>-0.010</td></tr>
<tr><td>T-60</td><td>0.791</td><td>-0.012</td></tr>
<tr><td>T-90</td><td>0.789</td><td>-0.014</td></tr>
</table>
<div class="find">Signal drop T-0→T-90: only 0.009. Sybil fingerprints are established early and persist.</div>
</div>
</details>

<details>
<summary>Phase 3: ARTEMIS GNN Reproduction <span class="tag">~3h</span></summary>
<div class="body">
<table>
<tr><th>Model</th><th>Timing</th><th>AUC</th></tr>
<tr><td>ArtemisNet (GraphSAGE)</td><td>Post-airdrop (full graph)</td><td class="hi">0.976</td></tr>
<tr><td>ArtemisNet (GraphSAGE)</td><td>Pre-airdrop T-30</td><td class="lo">0.586</td></tr>
<tr><td>LightGBM</td><td>Pre-airdrop T-30</td><td class="hi">0.793</td></tr>
</table>
<div class="warn">GNN relies on post-airdrop transfer edges (token consolidation). Remove those edges → AUC drops from 0.976 to 0.586. LightGBM behavioral features are unaffected by timing.</div>
</div>
</details>

<details>
<summary>Phase 4: Cross-Protocol Validation <span class="tag">~4h</span></summary>
<div class="body">
<table>
<tr><th>Experiment</th><th>AUC</th><th>Note</th></tr>
<tr><td>LayerZero T-30</td><td class="hi">0.946</td><td>Exceeds ARTEMIS baseline</td></tr>
<tr><td>LOPO: Hop→LZ</td><td>0.567</td><td>Zero-shot transfer</td></tr>
<tr><td>LOPO: Blur→LZ</td><td>0.434</td><td>Zero-shot transfer</td></tr>
<tr><td>Blur→Hop (zero-shot)</td><td>0.500</td><td>Random-level</td></tr>
<tr><td>Blur→Hop (1% fine-tune)</td><td class="hi">0.982</td><td>Minimal fine-tuning recovers</td></tr>
</table>
</div>
</details>

</div>
</details>

<details>
<summary>Parallelism & Quality Control <span class="tag">workflow</span></summary>
<div class="body">

<details>
<summary>Sub-agent Parallel Strategy</summary>
<div class="body">
<div class="note">Rule: max 2-3 concurrent sub-agents (avoid API 429 rate limits)</div>
<table>
<tr><th>Pattern</th><th>Example</th></tr>
<tr><td>Independent parallel</td><td>LZ data fetch ∥ Hop data fetch ∥ Gitcoin features</td></tr>
<tr><td>Dependent serial</td><td>Feature engineering → Model training → SHAP analysis</td></tr>
<tr><td>Fan-out verification</td><td>Main agent spawns reviewer sub-agent for each completed experiment</td></tr>
</table>
</div>
</details>

<details>
<summary>Quality Assurance</summary>
<div class="body">
<table>
<tr><th>Check</th><th>Method</th></tr>
<tr><td>Self-verification</td><td>Each script prints AUC, sample count, feature dims</td></tr>
<tr><td>Cross-validation</td><td>5-fold CV (not single split)</td></tr>
<tr><td>Cross-model</td><td>LightGBM vs GNN comparison</td></tr>
<tr><td>Cross-dataset</td><td>Blur vs LZ vs Hop consistency</td></tr>
<tr><td>Git safety net</td><td>Every experiment = one commit, revert anytime</td></tr>
</table>
</div>
</details>

</div>
</details>

<details>
<summary>Prompting Techniques (How Adeline Communicates) <span class="tag data">tips</span></summary>
<div class="body">

<details>
<summary>6 Prompting Patterns</summary>
<div class="body">
<table>
<tr><th>#</th><th>Pattern</th><th>Example</th></tr>
<tr><td>1</td><td>One-line direction, AI decomposes</td><td>"复现 ARTEMIS 并验证事前检测可行性"</td></tr>
<tr><td>2</td><td>Point to problem, not solution</td><td>"标签文件用错了，应该用 behavior_flags"</td></tr>
<tr><td>3</td><td>Challenge results</td><td>"GNN 事前为什么跌这么多？去查"</td></tr>
<tr><td>4</td><td>Give data path, let AI explore</td><td>"你自己去桌面看"</td></tr>
<tr><td>5</td><td>Batch assign + parallel</td><td>"LZ/Gitcoin/Hop 的 inferred 全部补齐"</td></tr>
<tr><td>6</td><td>Correct immediately</td><td>"我说了，只入库以太坊空投结束的项目"</td></tr>
</table>
</div>
</details>

<details>
<summary>Key Principles</summary>
<div class="body">
<table>
<tr><th>Do</th><th>Don't</th></tr>
<tr><td>Say WHAT to do</td><td>Say HOW to do it step-by-step</td></tr>
<tr><td>Give context & data paths</td><td>Write detailed procedures</td></tr>
<tr><td>Challenge suspicious results</td><td>Blindly accept AI output</td></tr>
<tr><td>Batch multiple tasks</td><td>Assign one at a time</td></tr>
<tr><td>Correct fast when wrong</td><td>Wait until AI finishes to correct</td></tr>
<tr><td>Demand DB verification</td><td>Accept "should be working"</td></tr>
</table>
</div>
</details>

</div>
</details>

<details>
<summary>Speed Comparison <span class="tag done">10x faster</span></summary>
<div class="body">
<table>
<tr><th>Step</th><th>Traditional</th><th>AI Agent</th><th>Speedup</th></tr>
<tr><td>Data import + cleaning</td><td>1-2 days</td><td>3 hours</td><td class="hi">5-8x</td></tr>
<tr><td>Feature engineering</td><td>3-5 days</td><td>4 hours</td><td class="hi">10-15x</td></tr>
<tr><td>Model training + tuning</td><td>2-3 days</td><td>2 hours</td><td class="hi">15-20x</td></tr>
<tr><td>GNN reproduction</td><td>1-2 weeks</td><td>3 hours</td><td class="hi">30-50x</td></tr>
<tr><td>Cross-protocol validation</td><td>3-5 days</td><td>4 hours</td><td class="hi">10-15x</td></tr>
<tr><td>Results compilation</td><td>2-3 days</td><td>1 hour</td><td class="hi">20-30x</td></tr>
<tr><td><b>Total</b></td><td><b>3-4 weeks</b></td><td><b>~20 hours</b></td><td class="hi"><b>~10x</b></td></tr>
</table>
<div class="find">Acceleration sources: code generation speed (10min vs 2-4h per script), parallel sub-agents, instant debugging, persistent context, 24/7 execution</div>
<div class="note">Human still irreplaceable for: research direction, experiment design, result interpretation, paper writing, catching label errors</div>
</div>
</details>

<details>
<summary>HasciDB2 — Sybil Detection Database <span class="tag data">extension</span></summary>
<div class="body">
<table>
<tr><th>Metric</th><th>Value</th></tr>
<tr><td>Projects</td><td>9 (Blur, Hop, LayerZero, Gitcoin, Across, hop_arb/op/eth/poly)</td></tr>
<tr><td>Total users</td><td>345,150</td></tr>
<tr><td>Official sybil</td><td>48,240</td></tr>
<tr><td>Inferred sybil</td><td>12,675</td></tr>
<tr><td>Rule config</td><td>config/rule_registry.json (bw/ml/fd/hf centralized)</td></tr>
<tr><td>Frontend</td><td>GitHub Pages: address search, project list, CSV export</td></tr>
</table>
<div class="note">GitHub: UW-Decentralized-Computing-Lab/HasciDB2</div>
</div>
</details>

<div class="lightbox" id="lightbox" onclick="closeLightbox()">
  <img id="lightbox-img" src="">
</div>
<script>
function setAll(o){document.querySelectorAll('details').forEach(d=>d.open=o);}
function toggleTheme(){const c=document.documentElement.getAttribute('data-theme');document.documentElement.setAttribute('data-theme',c==='light'?'':'light');}
function openLightbox(img){document.getElementById('lightbox-img').src=img.src;document.getElementById('lightbox').classList.add('open');event.stopPropagation();}
function closeLightbox(){document.getElementById('lightbox').classList.remove('open');}
function doSearch(q){q=q.trim().toLowerCase();document.querySelectorAll('details').forEach(d=>{d.style.display=(!q||d.innerText.toLowerCase().includes(q))?'':'none';if(q&&d.innerText.toLowerCase().includes(q))d.open=true;});}
document.addEventListener('keydown',e=>{if(e.key==='Escape')closeLightbox();});
</script>
</body>
</html>
